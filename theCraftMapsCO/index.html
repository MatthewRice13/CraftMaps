<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Craft Maps</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="vendor/simple-line-icons/css/simple-line-icons.css">
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/new-age.min.css" rel="stylesheet">
  </head>

  <body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="index.html">CRAFT MAPS</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">How to use</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#contact">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <header class="masthead">
      <div class="location-container">
        <div class="container">
          <small class="mb-2 d-block">Starting location should be within Ireland i.e Hotel, CO.</small>
          <div class="input-group mb-0">
            <input type="text" class="form-control location-input" placeholder="Enter your starting location" aria-label="Recipient's username" aria-describedby="basic-addon2">
            <div class="input-group-append">
              <button id="getDirecButton" class="btn btn-outline" type="button">Go</button>
            </div>
          </div>
        </div>
      </div>
      <div class="map-container">
        <div id="map"></div>
      </div>
    </header>


    <section class="contact bg-primary" id="contact">
      <div class="container">
        <h2>We
          <i class="fa fa-heart"></i>
          new friends!</h2>
        <ul class="list-inline list-social">
          <li class="list-inline-item social-twitter">
            <a href="#">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li class="list-inline-item social-facebook">
            <a href="#">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li class="list-inline-item social-google-plus">
            <a href="#">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
      </div>
    </section>

    <footer>
      <div class="container">
        <p>&copy; Craft Maps 2018</p>
        <ul class="list-inline">
          <li class="list-inline-item">
            <a href="#">Privacy</a>
          </li>
          <li class="list-inline-item">
            <a href="#">Terms</a>
          </li>
          <li class="list-inline-item">
            <a href="#">FAQ</a>
          </li>
        </ul>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/new-age.min.js"></script>

    <script src="https://maps.googleapis.com/maps/api/js"></script>


    <script>
      var infoWindow;
      var currentLat;
      var currentLng;
      var map;
      var directionsDisplay;
      var directionsService = new google.maps.DirectionsService();
      var directionsMap;
      var start;
      var end;
      $(document).ready(function() {
        getLocation();
        $("#getDirecButton").on('click', function() {
          //console.log("clicked");
          getDirections();
        });

        //initMap();
      });

      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        } else {
          console.log('error') //x.innerHTML = "Geolocation is not supported by this browser.";
        }
        //initMap();
      }

      function showPosition(position) {
        //console.log(position.coords.latitude);
        currentLat = position.coords.latitude;
        //console.log(position.coords.longitude);
        currentLng = position.coords.longitude;
        /*x.innerHTML = "Latitude: " + position.coords.latitude +
        "<br>Longitude: " + position.coords.longitude;*/
        startPoint = new google.maps.LatLng(currentLat, currentLng);
        initMap();
      }

      function initMap() {
        // Map options
        var options = {
          zoom: 10,
          //center:{lat:53.3498,lng:-6.2603}
          //center:{lat:currentLat,lng:currentLng}
          center: new google.maps.LatLng(currentLat, currentLng)
        }

        // New map
        //var map = new google.maps.Map(document.getElementById('map'), options);
        map = new google.maps.Map(document.getElementById('map'), options);

        // Listen for click on map
        /*google.maps.event.addListener(map, 'click', function(event){
        	// Add marker
        	addMarker({coords:event.latLng});
        });*/

        //breweries data
        var breweriesJson = [{
            name: 'Wood Key Brewing',
            coords: {
              lat: 53.2989858,
              lng: -6.2603187
            },
            //iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
            content: "<h1 id='hi'>WKB</h1>"
          },
          {
            name: 'Rascals Brewing',
            coords: {
              lat: 53.2989858,
              lng: -6.4627311
            },
            // iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
            content: '<h1>RB</h1>'
          },
          {
            name: 'Stone Barrel Brewing',
            coords: {
              lat: 53.3311481,
              lng: -6.2603187
            },
            // iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
            content: '<h1>SBB</h1>'
          }
        ];
        // Loop through markers
        for (var i = 0; i < breweriesJson.length; i++) {
          // Add marker
          addMarker(breweriesJson[i]);
        }

        // Add Marker Function
        function addMarker(props) {
          var marker = new google.maps.Marker({
            position: props.coords,
            title: props.name,
            map: map,
            //icon:props.iconImage
          });

          // Check for customicon
          if (props.iconImage) {
            // Set icon image
            marker.setIcon(props.iconImage);
          }

          // Check content
          if (props.content) {


            marker.addListener('click', function() {
              if (typeof infoWindow != 'undefined') {
                infoWindow.close();
              }
              infoWindow = new google.maps.InfoWindow({
                content: props.content
              });
              infoWindow.open(map, marker);
            });
          }
        }

      }

      function getDirections() {
        //$("map").empty();
        //console.log('getDirections');
        directionsDisplay = new google.maps.DirectionsRenderer();
        //start = new google.maps.LatLng(directionsLatLng);
        var directionsOptions = {
          zoom: 10,
          center: startPoint
        }
        directionsMap = new google.maps.Map(document.getElementById('map'), directionsOptions);
        directionsDisplay.setMap(directionsMap);
        calcRoute();
      }

      function calcRoute() {
        //console.log("calcRoute");
        start = startPoint; //directionsLatLng;
        end = {
          lat: 53.2989858,
          lng: -6.4627311
        }; //"50 Rue Ste-Catherine O MontrÃ©al, QC H2X 1Z6";
        var request = {
          origin: start,
          destination: end,
          travelMode: google.maps.TravelMode.TRANSIT
        };
        directionsService.route(request, function(result, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(result);
          }
        });
      }

    </script>

  </body>

</html>
